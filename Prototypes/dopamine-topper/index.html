<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dopamine Topper Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: ["class"],
        theme: {
          extend: {
            colors: {
              border: "hsl(var(--border))",
              input: "hsl(var(--input))",
              ring: "hsl(var(--ring))",
              background: "hsl(var(--background))",
              foreground: "hsl(var(--foreground))",
              primary: {
                DEFAULT: "hsl(var(--primary))",
                foreground: "hsl(var(--primary-foreground))",
              },
              secondary: {
                DEFAULT: "hsl(var(--secondary))",
                foreground: "hsl(var(--secondary-foreground))",
              },
              destructive: {
                DEFAULT: "hsl(var(--destructive))",
                foreground: "hsl(var(--destructive-foreground))",
              },
              muted: {
                DEFAULT: "hsl(var(--muted))",
                foreground: "hsl(var(--muted-foreground))",
              },
              accent: {
                DEFAULT: "hsl(var(--accent))",
                foreground: "hsl(var(--accent-foreground))",
              },
              card: {
                DEFAULT: "hsl(var(--card))",
                foreground: "hsl(var(--card-foreground))",
              },
            },
            borderRadius: {
              lg: "var(--radius)",
              md: "calc(var(--radius) - 2px)",
              sm: "calc(var(--radius) - 4px)",
            },
          },
        },
      };
    </script>
    <style>
      .theme-zinc {
        --background: 0 0% 100%;
        --foreground: 240 10% 3.9%;

        --muted: 240 4.8% 95.9%;
        --muted-foreground: 240 3.8% 46.1%;

        --popover: 0 0% 100%;
        --popover-foreground: 240 10% 3.9%;

        --card: 0 0% 100%;
        --card-foreground: 240 10% 3.9%;

        --border: 240 5.9% 90%;
        --input: 240 5.9% 90%;

        --primary: 240 5.9% 10%;
        --primary-foreground: 0 0% 98%;

        --secondary: 240 4.8% 95.9%;
        --secondary-foreground: 240 5.9% 10%;

        --accent: 240 4.8% 95.9%;
        --accent-foreground: 240 5.9% 10%;

        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 0 0% 98%;

        --ring: 240 5.9% 10%;

        --radius: 0.5rem;
      }

      .dark .theme-zinc {
        --background: 240 10% 3.9%;
        --foreground: 0 0% 98%;

        --muted: 240 3.7% 15.9%;
        --muted-foreground: 240 5% 64.9%;

        --popover: 240 10% 3.9%;
        --popover-foreground: 0 0% 98%;

        --card: 240 10% 3.9%;
        --card-foreground: 0 0% 98%;

        --border: 240 3.7% 15.9%;
        --input: 240 3.7% 15.9%;

        --primary: 0 0% 98%;
        --primary-foreground: 240 5.9% 10%;

        --secondary: 240 3.7% 15.9%;
        --secondary-foreground: 0 0% 98%;

        --accent: 240 3.7% 15.9%;
        --accent-foreground: 0 0% 98%;

        --destructive: 0 62.8% 30.6%;
        --destructive-foreground: 0 0% 98%;

        --ring: 240 4.9% 83.9%;
      }
    </style>
  </head>
  <body class="theme-zinc bg-background text-foreground p-6">
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script type="text/babel">
      const initialPosts = [
        { id: 1, quizMaster: 'Alice', type: 'Trivia', genre: 'Science', question: 'What is H2O?', options: ['Water', 'Oxygen', 'Hydrogen'], answer: 'Water' },
        { id: 2, quizMaster: 'Bob', type: 'Riddle', genre: 'History', question: 'Who crossed the Rubicon?', options: ['Caesar', 'Napoleon', 'Hannibal'], answer: 'Caesar' },
        { id: 3, quizMaster: 'Carol', type: 'Puzzle', genre: 'Math', question: 'What is 2 + 2?', options: ['3', '4', '5'], answer: '4' },
      ];

      function Post({ post, onLockType, onLockGenre }) {
        const [selected, setSelected] = React.useState(null);
        const [result, setResult] = React.useState(null);
        const [comments, setComments] = React.useState([]);
        const [commentText, setCommentText] = React.useState('');

        const choose = (opt) => {
          setSelected(opt);
          setResult(opt === post.answer ? 'Correct!' : 'Try again!');
        };

        const addComment = () => {
          if (commentText.trim()) {
            setComments([...comments, commentText]);
            setCommentText('');
          }
        };

        return (
          <div className="border rounded-lg p-4 mb-5 bg-card text-card-foreground">
            <h2 className="text-lg font-semibold">{post.quizMaster}'s {post.type} ({post.genre})</h2>
            <p className="mt-2">{post.question}</p>
            <div className="mt-2 space-x-2">
              {post.options.map(opt => (
                <button
                  key={opt}
                  onClick={() => choose(opt)}
                  disabled={selected !== null}
                  className="rounded bg-primary px-2 py-1 text-sm text-primary-foreground disabled:opacity-50"
                >
                  {opt}
                </button>
              ))}
            </div>
            {result && <p className="mt-2 font-medium">{result}</p>}

            <div className="mt-4">
              <h3 className="font-semibold">Discussion</h3>
              {comments.map((c, i) => (
                <div key={i} className="ml-2 text-sm">â€¢ {c}</div>
              ))}
              <div className="mt-2 flex gap-2">
                <input
                  className="flex-grow rounded border px-2 py-1"
                  value={commentText}
                  onChange={e => setCommentText(e.target.value)}
                  placeholder="Share your thoughts"
                />
                <button
                  className="rounded bg-secondary px-2 py-1 text-secondary-foreground"
                  onClick={addComment}
                >
                  Post
                </button>
              </div>
            </div>

            <div className="mt-4 flex gap-2">
              <button
                className="rounded bg-accent px-2 py-1 text-accent-foreground"
                onClick={onLockType}
              >
                Lock POST_TYPE
              </button>
              <button
                className="rounded bg-accent px-2 py-1 text-accent-foreground"
                onClick={onLockGenre}
              >
                Lock POST_GENRE
              </button>
            </div>
          </div>
        );
      }

      function App() {
        const [lockedType, setLockedType] = React.useState(null);
        const [lockedGenre, setLockedGenre] = React.useState(null);

        const filtered = initialPosts.filter(
          p =>
            (!lockedType || p.type === lockedType) &&
            (!lockedGenre || p.genre === lockedGenre)
        );

        return (
          <div className="max-w-xl mx-auto">
            <h1 className="mb-4 text-2xl font-bold">Dopamine Topper</h1>
            {lockedType && (
              <p className="mb-2">
                Filtering by type: {lockedType}
                <button
                  className="ml-2 rounded bg-destructive px-2 py-1 text-destructive-foreground"
                  onClick={() => setLockedType(null)}
                >
                  Clear
                </button>
              </p>
            )}
            {lockedGenre && (
              <p className="mb-2">
                Filtering by genre: {lockedGenre}
                <button
                  className="ml-2 rounded bg-destructive px-2 py-1 text-destructive-foreground"
                  onClick={() => setLockedGenre(null)}
                >
                  Clear
                </button>
              </p>
            )}
            {filtered.map(post => (
              <Post
                key={post.id}
                post={post}
                onLockType={() => setLockedType(post.type)}
                onLockGenre={() => setLockedGenre(post.genre)}
              />
            ))}
            {filtered.length === 0 && <p>No posts match the selected filters.</p>}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
